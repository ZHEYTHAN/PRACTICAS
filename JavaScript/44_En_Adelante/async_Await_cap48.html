<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CAP 48 --- ASYNC & AWAIT</title>
</head>
<body>
  <h1>CAP 48 --- ASYNC & AWAIT</h1>
  <script>

    // Para decirle a JavaScript de que la función es asincrona, se debe anteponer antes de la función la palabra async, como el ejemplo de abajo ↓↓↓
    
    function cuadradoPromise(value){
      if(typeof value !== "number"){
        return Promise.reject(`El valor "${value}" no es de tipo número, verifique e intente nuevamente`);
      }

      return new Promise((resolve, reject)=>{
        setTimeout(() => {
          resolve({
            value,
            result: value * value
          })
        }, 100);
      });
    }

    //async se puede usar tanto en funciones declaradas -- como en funciones anonimas, esto dependerá de donde se ubique el async.
    //Para esta funcion declarada se debe colocar el async al inicio de la función.
    //Lo que se hace aquí es que una función aproveche un promise.

    async function funcionAsincronaDeclarada(){

      try{
        console.log(`Inicio de parte Async Function`);

        let obj= await cuadradoPromise(0);
        console.log(`Async Function: ${obj.value}, ${obj.result}`);

        obj = await cuadradoPromise(1);
        console.log(`Asyn Function: ${obj.value}, ${obj.result }`);

        obj = await cuadradoPromise(2);
        console.log(`Asyn Function: ${obj.value}, ${obj.result }`);

        obj = await cuadradoPromise(3);
        console.log(`Asyn Function: ${obj.value}, ${obj.result }`);

        obj = await cuadradoPromise(4);
        console.log(`Asyn Function: ${obj.value}, ${obj.result }`);

        obj = await cuadradoPromise(5);
        console.log(`Asyn Function: ${obj.value}, ${obj.result }`);

        console.log("Fin de Async Function");
        
      } catch(err){
        console.error(err);
      }

    }

    funcionAsincronaDeclarada();

    // Función expresada o anónima== ↓↓↓↓
    // En estas funciones se debe escribir la palabra async antes de la declaración del arrow function, es decír, antes de los parentesis.

    const funcionAsincronaExpresada = async() =>{
      try{

        console.log("Inicio async de función expresada / anónima");

        obj = await cuadradoPromise(6);
        console.log(`Asyn Function: ${obj.value}, ${obj.result }`);

        obj = await cuadradoPromise(7);
        console.log(`Asyn Function: ${obj.value}, ${obj.result }`);

        obj = await cuadradoPromise(8);
        console.log(`Asyn Function: ${obj.value}, ${obj.result }`);

        obj = await cuadradoPromise(9);
        console.log(`Asyn Function: ${obj.value}, ${obj.result }`);

        obj = await cuadradoPromise(10);
        console.log(`Asyn Function: ${obj.value}, ${obj.result }`);

        obj = await cuadradoPromise(11);
        console.log(`Asyn Function: ${obj.value}, ${obj.result }`);

        console.log("Fin de async de función expresada / anónima");

      } catch (err){
        console.error(err);
      }
    }

    funcionAsincronaExpresada();


  </script>
</body>
</html>